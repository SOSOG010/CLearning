# 局部变量

把在函数体内声明的变量称为局部变量。局部变量具有下列性质：

- **自动存储期限**

  局部变量的存储单元是在函数被调用时“自动”分配的，函数返回时收回分配。

  > ps：包含局部变量的函数返回时，局部变量的值无法保留。当再次调用该函数时，无法保证变量仍有原来的值。

- **块作用域**

  从变量声明的点开始一直到所在函数体的末尾。

C99不要求在函数一开始就进行变量声明，所以局部变量的作用域可能非常小。比如在for语句中的变量声明。

## 静态局部变量

在局部变量声明时加上static修饰，可以使变量具有**静态存储期限**（静态存储期限的变量在整个程序执行期间都拥有存储单元，都会保留变量的值）。函数返回时变量的值也不会丢失！

如果在递归函数中使得局部变量具有静态存储期限（即声明为static静态变量）就能够避免在每次递归调用本身时自动声明同样的变量，产生同样的副本。而静态变量所有相同的函数调用都共享一个静态变量，可以减少开销。

> 注：形式参数拥有和局部变量一样的性质，事实上，形参和局部变量唯一区别就是在每次函数调用时会自动对形参初始化。



# 外部变量（全局变量）

函数还可以通过外部变量（external variable）进行通信。外部变量是声明在任何函数体外的。

- 静态存储期限：类似于声明为static的局部变量，外部变量拥有静态存储期限。存储在外部变量中的值将一直保留。
- 文件作用域：从变量被声明的点开始一直到所在文件的末尾。因此，跟随在外部变量声明之后的所有函数都可以访问它。



外部函数的利弊：

在多个函数必须共享一个变量或少数几个函数共享大量变量时，外部变量是很有用的。但在大多数情况下，对于函数而言，通过形式参数通信比共享变量的方法更好。

①在程序维护期间，如果改变外部变量，那么将需要检查同一文件中的每个函数，以确认该变化对函数的影响。

